0: WARNING 24-11-16 15:41:02.848625 - 0:00:00 - Signal handler installed.
0: WARNING 24-11-16 15:41:02.848917 - 0:00:00 - WARNING: Setting MKL_SERVICE_FORCE_INTEL to GNU
0: WARNING 24-11-16 15:41:02.849007 - 0:00:00 - WARNING: Setting OMP_NUM_THREADS to 1
0: WARNING 24-11-16 15:41:02.849112 - 0:00:00 - WARNING: Setting MKL_NUM_THREADS to 1
0: WARNING 24-11-16 15:41:02.849178 - 0:00:00 - WARNING: Setting ENABLE_INTRA_NODE_COMM to 1
0: WARNING 24-11-16 15:41:02.849231 - 0:00:00 - WARNING: Setting TORCH_NCCL_AVOID_RECORD_STREAMS to 1
0: WARNING 24-11-16 15:41:02.849282 - 0:00:00 - WARNING: Setting NCCL_IB_TIMEOUT to 22
0: WARNING 24-11-16 15:41:02.849329 - 0:00:00 - WARNING: Setting NCCL_DEBUG to INFO
0: WARNING 24-11-16 15:41:02.849384 - 0:00:00 - WARNING: Setting TRITON_CACHE_DIR to /scratch/ya255/tmp/tmp0uueh8ww
0: INFO    24-11-16 15:41:07.474520 - 0:00:05 - Run launched with torchrun, local rank: 0
0: INFO    24-11-16 15:41:07.474811 - 0:00:05 - ENV: environ({'SHELL': '/bin/bash', 'SLURM_STEP_NUM_TASKS': '3', 'SLURM_JOB_USER': 'ya255', 'SLURM_TASKS_PER_NODE': '3', 'SLURM_JOB_UID': '1642556', 'SLURM_STEP_GPUS': '0', 'SLURM_CPU_BIND': 'quiet,mask_cpu:0x0000000000000001,0x0000000000000004,0x0000000000000008', 'SLURM_TASK_PID': '2950149', 'CONDA_EXE': '/share/apps/anaconda3/2021.05/bin/conda', '_CE_M': '', 'TMUX': '/tmp/tmux-1642556/default,2233183,4', 'SLURM_LOCALID': '0', 'SLURM_SUBMIT_DIR': '/home/ya255', 'SLURM_CPU_BIND_VERBOSE': 'quiet', 'SLURMD_NODENAME': 'abdelfattah-compute-03', 'SLURM_STEP_NODELIST': 'abdelfattah-compute-03', 'SLURM_CLUSTER_NAME': 'g2', 'SLURM_CPUS_ON_NODE': '3', 'SLURM_UMASK': '0002', 'SLURM_JOB_CPUS_PER_NODE': '3', 'ENV': '/usr/share/modules/init/profile.sh', 'SLURM_GPUS_ON_NODE': '1', 'KRB5CCNAME': 'FILE:/tmp/krb5cc_1642556_HhGMYr', 'PWD': '/scratch/ya255/lingua', 'SLURM_GTIDS': '0,1,2', 'LOGNAME': 'ya255', 'CONDA_PREFIX': '/home/ya255/.conda/envs/lingua_241023', 'SLURM_JOB_PARTITION': 'abdelfattah-interactive', 'MODULESHOME': '/usr/share/modules', 'MANPATH': ':', 'ROCR_VISIBLE_DEVICES': '0', 'SLURM_JOB_NUM_NODES': '1', 'SRUN_DEBUG': '3', 'SLURM_STEPID': '0', 'SLURM_CPU_BIND_LIST': '0x0000000000000001,0x0000000000000004,0x0000000000000008', 'SLURM_JOBID': '5887989', 'SLURM_PTY_PORT': '62270', 'SLURM_LAUNCH_NODE_IPADDR': '128.84.101.4', 'SLURM_JOB_QOS': 'normal', 'MOTD_SHOWN': 'pam', 'SLURM_PTY_WIN_ROW': '14', 'HOME': '/home/ya255', 'LANG': 'en_US.UTF-8', 'SLURM_CPU_BIND_TYPE': 'mask_cpu:', 'LS_COLORS': 'rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:', 'SLURM_PROCID': '0', 'CONDA_PROMPT_MODIFIER': '(lingua_241023) ', 'TMPDIR': '/scratch/ya255/tmp', 'SLURM_NTASKS': '3', 'SLURM_TOPOLOGY_ADDR': 'abdelfattah-compute-03', 'SSH_CONNECTION': '10.41.228.20 49376 128.84.101.4 22', 'SLURM_DISTRIBUTION': 'block,pack', 'ZE_AFFINITY_MASK': '0', 'SLURM_TOPOLOGY_ADDR_PATTERN': 'node', 'CUDA_VISIBLE_DEVICES': '0', 'SLURM_SRUN_COMM_HOST': '128.84.101.4', 'HF_HOME': '/scratch/ya255/huggingface', 'LESSCLOSE': '/usr/bin/lesspipe %s %s', 'MODULEPATH_modshare': '/etc/environment-modules/modules:1:/usr/share/modules/$MODULE_VERSION/modulefiles:1:/usr/share/modules/modulefiles:1:/usr/share/modules/versions:1', 'SLURM_WORKING_CLUSTER': 'g2:slurmctld:6817:9728:109', 'TERM': 'screen', '_CE_CONDA': '', 'SLURM_PTY_WIN_COL': '248', 'LESSOPEN': '| /usr/bin/lesspipe %s', 'USER': 'ya255', 'TMUX_PANE': '%25', 'SLURM_NODELIST': 'abdelfattah-compute-03', 'GPU_DEVICE_ORDINAL': '0', 'CONDA_SHLVL': '2', 'SLURM_SRUN_COMM_PORT': '62271', 'LOADEDMODULES': '', 'SLURM_STEP_ID': '0', 'SLURM_JOB_ACCOUNT': 'abdelfattah', 'SLURM_PRIO_PROCESS': '0', 'SLURM_NPROCS': '3', 'SHLVL': '3', 'SLURM_NNODES': '1', 'BASH_ENV': '/usr/share/modules/init/bash', 'SLURM_SUBMIT_HOST': 'g2-login-05.coecis.cornell.edu', 'CONDA_PYTHON_EXE': '/share/apps/anaconda3/2021.05/bin/python', 'LD_LIBRARY_PATH': '/home/ya255/cuda-11.8/lib64', 'SLURM_JOB_ID': '5887989', 'SLURM_NODEID': '0', 'SLURM_STEP_NUM_NODES': '1', 'SSH_CLIENT': '10.41.244.132 38532 22', 'CONDA_DEFAULT_ENV': 'lingua_241023', 'SLURM_STEP_TASKS_PER_NODE': '3', 'CUDA_HOME': '/home/ya255/cuda-11.8', 'SLURM_CONF': '/usr/local/slurm/slurm-22.05.8/etc/slurm.conf', 'PATH': '/home/ya255/cuda-11.8/bin:/home/ya255/cuda-12.1/bin:/home/ya255/.local/bin:/home/ya255/.conda/envs/lingua_241023/bin:/home/ya255/.local/bin:/home/ya255/cuda-11.8/bin:/home/ya255/cuda-12.1/bin:/home/ya255/.local/bin:/share/apps/anaconda3/2021.05/bin:/usr/local/slurm/current/bin:/usr/local/slurm/current/sbin:/usr/local/openmpi/current/bin:/usr/local/openmpi/current:/usr/local/slurm/current/bin:/usr/local/slurm/current/sbin:/usr/local/openmpi/current/bin:/usr/local/openmpi/current:/home/ya255/.local/bin:/home/ya255/cuda-11.8/bin:/home/ya255/cuda-12.1/bin:/home/ya255/.local/bin:/share/apps/anaconda3/2021.05/bin:/share/apps/anaconda3/2021.05/condabin:/share/apps/anaconda3/2021.05/bin:/usr/local/slurm/current/bin:/usr/local/slurm/current/sbin:/usr/local/openmpi/current/bin:/usr/local/openmpi/current:/usr/local/slurm/current/bin:/usr/local/slurm/current/sbin:/usr/local/openmpi/current/bin:/usr/local/openmpi/current:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin', 'SLURM_JOB_NAME': 'bash', 'MODULEPATH': '/etc/environment-modules/modules:/usr/share/modules/versions:/usr/share/modules/$MODULE_VERSION/modulefiles:/usr/share/modules/modulefiles', 'SSH_TTY': '/dev/pts/155', 'CONDA_PREFIX_1': '/share/apps/anaconda3/2021.05', 'SLURM_STEP_LAUNCHER_PORT': '62271', 'SLURM_JOB_GID': '1658701', 'SLURM_JOB_NODELIST': 'abdelfattah-compute-03', 'MODULES_CMD': '/usr/lib/x86_64-linux-gnu/modulecmd.tcl', 'BASH_FUNC_switchml%%': '() {  typeset swfound=1;\n if [ "${MODULES_USE_COMPAT_VERSION:-0}" = \'1\' ]; then\n typeset swname=\'main\';\n if [ -e /usr/lib/x86_64-linux-gnu/modulecmd.tcl ]; then\n typeset swfound=0;\n unset MODULES_USE_COMPAT_VERSION;\n fi;\n else\n typeset swname=\'compatibility\';\n if [ -e /usr/lib/x86_64-linux-gnu/modulecmd-compat ]; then\n typeset swfound=0;\n MODULES_USE_COMPAT_VERSION=1;\n export MODULES_USE_COMPAT_VERSION;\n fi;\n fi;\n if [ $swfound -eq 0 ]; then\n echo "Switching to Modules $swname version";\n source /usr/share/modules/init/bash;\n else\n echo "Cannot switch to Modules $swname version, command not found";\n return 1;\n fi\n}', 'BASH_FUNC_module%%': '() {  _module_raw "$@" 2>&1\n}', 'BASH_FUNC__module_raw%%': '() {  unset _mlshdbg;\n if [ "${MODULES_SILENT_SHELL_DEBUG:-0}" = \'1\' ]; then\n case "$-" in \n *v*x*)\n set +vx;\n _mlshdbg=\'vx\'\n ;;\n *v*)\n set +v;\n _mlshdbg=\'v\'\n ;;\n *x*)\n set +x;\n _mlshdbg=\'x\'\n ;;\n *)\n _mlshdbg=\'\'\n ;;\n esac;\n fi;\n unset _mlre _mlIFS;\n if [ -n "${IFS+x}" ]; then\n _mlIFS=$IFS;\n fi;\n IFS=\' \';\n for _mlv in ${MODULES_RUN_QUARANTINE:-};\n do\n if [ "${_mlv}" = "${_mlv##*[!A-Za-z0-9_]}" -a "${_mlv}" = "${_mlv#[0-9]}" ]; then\n if [ -n "`eval \'echo ${\'$_mlv\'+x}\'`" ]; then\n _mlre="${_mlre:-}${_mlv}_modquar=\'`eval \'echo ${\'$_mlv\'}\'`\' ";\n fi;\n _mlrv="MODULES_RUNENV_${_mlv}";\n _mlre="${_mlre:-}${_mlv}=\'`eval \'echo ${\'$_mlrv\':-}\'`\' ";\n fi;\n done;\n if [ -n "${_mlre:-}" ]; then\n eval `eval ${_mlre}/usr/bin/tclsh8.6 /usr/lib/x86_64-linux-gnu/modulecmd.tcl bash \'"$@"\'`;\n else\n eval `/usr/bin/tclsh8.6 /usr/lib/x86_64-linux-gnu/modulecmd.tcl bash "$@"`;\n fi;\n _mlstatus=$?;\n if [ -n "${_mlIFS+x}" ]; then\n IFS=$_mlIFS;\n else\n unset IFS;\n fi;\n unset _mlre _mlv _mlrv _mlIFS;\n if [ -n "${_mlshdbg:-}" ]; then\n set -$_mlshdbg;\n fi;\n unset _mlshdbg;\n return $_mlstatus\n}', 'OLDPWD': '/home/ya255', '_': '/home/ya255/.conda/envs/lingua_241023/bin/torchrun', 'LOCAL_RANK': '0', 'RANK': '0', 'GROUP_RANK': '0', 'ROLE_RANK': '0', 'ROLE_NAME': 'default', 'LOCAL_WORLD_SIZE': '1', 'WORLD_SIZE': '1', 'GROUP_WORLD_SIZE': '1', 'ROLE_WORLD_SIZE': '1', 'MASTER_ADDR': '127.0.0.1', 'MASTER_PORT': '29506', 'TORCHELASTIC_RESTART_COUNT': '0', 'TORCHELASTIC_MAX_RESTARTS': '0', 'TORCHELASTIC_RUN_ID': 'none', 'TORCHELASTIC_USE_AGENT_STORE': 'True', 'TORCH_NCCL_ASYNC_ERROR_HANDLING': '1', 'TORCHELASTIC_ERROR_FILE': '/scratch/ya255/tmp/torchelastic_qwllv5fd/none_g85o5ibm/attempt_0/0/error.json', 'CUDA_MODULE_LOADING': 'LAZY', 'MKL_SERVICE_FORCE_INTEL': 'GNU', 'OMP_NUM_THREADS': '1', 'MKL_NUM_THREADS': '1', 'ENABLE_INTRA_NODE_COMM': '1', 'TORCH_NCCL_AVOID_RECORD_STREAMS': '1', 'NCCL_IB_TIMEOUT': '22', 'NCCL_DEBUG': 'INFO', 'TRITON_CACHE_DIR': '/scratch/ya255/tmp/tmp0uueh8ww'})
0: INFO    24-11-16 15:41:07.504019 - 0:00:05 - Starting job: xmer_60k_dclm_65M
0: INFO    24-11-16 15:41:07.504283 - 0:00:05 - Running on dp rank : 0
0: INFO    24-11-16 15:41:07.504388 - 0:00:05 - Running on dp size : 1
0: INFO    24-11-16 15:41:07.506793 - 0:00:05 - Building model
0: INFO    24-11-16 15:41:07.559102 - 0:00:05 - Model is built !
0: INFO    24-11-16 15:41:09.681526 - 0:00:07 - Model size: 21,499,136 total parameters
0: INFO    24-11-16 15:41:09.682573 - 0:00:07 - GPU capacity: NVIDIA RTX A6000 (0) with 47.54GiB memory
0: INFO    24-11-16 15:41:09.683990 - 0:00:07 - GPU memory usage: NVIDIA RTX A6000 (0): 47.535888671875 GiB capacity, 0.134765625 GiB peak, 0.28350290436399306% peak
0: INFO    24-11-16 15:41:09.684067 - 0:00:07 - Starting build of optimizer...
0: INFO    24-11-16 15:41:09.684453 - 0:00:07 - Done with build of optimizer.
0: INFO    24-11-16 15:41:09.686431 - 0:00:07 - Async dataloader started
0: INFO    24-11-16 15:41:09.687433 - 0:00:07 - Profiling active.  Traces will be saved at /scratch/ya255/lingua/reported_runs/xmer_60k_dclm_65M/profiling
0: INFO    24-11-16 15:41:09.687677 - 0:00:07 - Starting MemSnapshotsProfilerWandb profiler...
0: INFO    24-11-16 15:41:13.820217 - 0:00:11 - Async data process 3001319 exited with code 1
0: INFO    24-11-16 15:41:13.820360 - 0:00:11 - Async dataloader cleaned up
0: WARNING 24-11-16 15:41:29.832641 - 0:00:00 - Signal handler installed.
0: WARNING 24-11-16 15:41:29.832972 - 0:00:00 - WARNING: Setting MKL_SERVICE_FORCE_INTEL to GNU
0: WARNING 24-11-16 15:41:29.833073 - 0:00:00 - WARNING: Setting OMP_NUM_THREADS to 1
0: WARNING 24-11-16 15:41:29.833164 - 0:00:00 - WARNING: Setting MKL_NUM_THREADS to 1
0: WARNING 24-11-16 15:41:29.833229 - 0:00:00 - WARNING: Setting ENABLE_INTRA_NODE_COMM to 1
0: WARNING 24-11-16 15:41:29.833283 - 0:00:00 - WARNING: Setting TORCH_NCCL_AVOID_RECORD_STREAMS to 1
0: WARNING 24-11-16 15:41:29.833337 - 0:00:00 - WARNING: Setting NCCL_IB_TIMEOUT to 22
0: WARNING 24-11-16 15:41:29.833384 - 0:00:00 - WARNING: Setting NCCL_DEBUG to INFO
0: WARNING 24-11-16 15:41:29.833437 - 0:00:00 - WARNING: Setting TRITON_CACHE_DIR to /scratch/ya255/tmp/tmptw5rni91
0: INFO    24-11-16 15:41:34.413931 - 0:00:05 - Run launched with torchrun, local rank: 0
0: INFO    24-11-16 15:41:34.414223 - 0:00:05 - ENV: environ({'SHELL': '/bin/bash', 'SLURM_STEP_NUM_TASKS': '3', 'SLURM_JOB_USER': 'ya255', 'SLURM_TASKS_PER_NODE': '3', 'SLURM_JOB_UID': '1642556', 'SLURM_STEP_GPUS': '0', 'SLURM_CPU_BIND': 'quiet,mask_cpu:0x0000000000000001,0x0000000000000004,0x0000000000000008', 'SLURM_TASK_PID': '2950149', 'CONDA_EXE': '/share/apps/anaconda3/2021.05/bin/conda', '_CE_M': '', 'TMUX': '/tmp/tmux-1642556/default,2233183,4', 'SLURM_LOCALID': '0', 'SLURM_SUBMIT_DIR': '/home/ya255', 'SLURM_CPU_BIND_VERBOSE': 'quiet', 'SLURMD_NODENAME': 'abdelfattah-compute-03', 'SLURM_STEP_NODELIST': 'abdelfattah-compute-03', 'SLURM_CLUSTER_NAME': 'g2', 'SLURM_CPUS_ON_NODE': '3', 'SLURM_UMASK': '0002', 'SLURM_JOB_CPUS_PER_NODE': '3', 'ENV': '/usr/share/modules/init/profile.sh', 'SLURM_GPUS_ON_NODE': '1', 'KRB5CCNAME': 'FILE:/tmp/krb5cc_1642556_HhGMYr', 'PWD': '/scratch/ya255/lingua', 'SLURM_GTIDS': '0,1,2', 'LOGNAME': 'ya255', 'CONDA_PREFIX': '/home/ya255/.conda/envs/lingua_241023', 'SLURM_JOB_PARTITION': 'abdelfattah-interactive', 'MODULESHOME': '/usr/share/modules', 'MANPATH': ':', 'ROCR_VISIBLE_DEVICES': '0', 'SLURM_JOB_NUM_NODES': '1', 'SRUN_DEBUG': '3', 'SLURM_STEPID': '0', 'SLURM_CPU_BIND_LIST': '0x0000000000000001,0x0000000000000004,0x0000000000000008', 'SLURM_JOBID': '5887989', 'SLURM_PTY_PORT': '62270', 'SLURM_LAUNCH_NODE_IPADDR': '128.84.101.4', 'SLURM_JOB_QOS': 'normal', 'MOTD_SHOWN': 'pam', 'SLURM_PTY_WIN_ROW': '14', 'HOME': '/home/ya255', 'LANG': 'en_US.UTF-8', 'SLURM_CPU_BIND_TYPE': 'mask_cpu:', 'LS_COLORS': 'rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:', 'SLURM_PROCID': '0', 'CONDA_PROMPT_MODIFIER': '(lingua_241023) ', 'TMPDIR': '/scratch/ya255/tmp', 'SLURM_NTASKS': '3', 'SLURM_TOPOLOGY_ADDR': 'abdelfattah-compute-03', 'SSH_CONNECTION': '10.41.228.20 49376 128.84.101.4 22', 'SLURM_DISTRIBUTION': 'block,pack', 'ZE_AFFINITY_MASK': '0', 'SLURM_TOPOLOGY_ADDR_PATTERN': 'node', 'CUDA_VISIBLE_DEVICES': '0', 'SLURM_SRUN_COMM_HOST': '128.84.101.4', 'HF_HOME': '/scratch/ya255/huggingface', 'LESSCLOSE': '/usr/bin/lesspipe %s %s', 'MODULEPATH_modshare': '/etc/environment-modules/modules:1:/usr/share/modules/$MODULE_VERSION/modulefiles:1:/usr/share/modules/modulefiles:1:/usr/share/modules/versions:1', 'SLURM_WORKING_CLUSTER': 'g2:slurmctld:6817:9728:109', 'TERM': 'screen', '_CE_CONDA': '', 'SLURM_PTY_WIN_COL': '248', 'LESSOPEN': '| /usr/bin/lesspipe %s', 'USER': 'ya255', 'TMUX_PANE': '%25', 'SLURM_NODELIST': 'abdelfattah-compute-03', 'GPU_DEVICE_ORDINAL': '0', 'CONDA_SHLVL': '2', 'SLURM_SRUN_COMM_PORT': '62271', 'LOADEDMODULES': '', 'SLURM_STEP_ID': '0', 'SLURM_JOB_ACCOUNT': 'abdelfattah', 'SLURM_PRIO_PROCESS': '0', 'SLURM_NPROCS': '3', 'SHLVL': '3', 'SLURM_NNODES': '1', 'BASH_ENV': '/usr/share/modules/init/bash', 'SLURM_SUBMIT_HOST': 'g2-login-05.coecis.cornell.edu', 'CONDA_PYTHON_EXE': '/share/apps/anaconda3/2021.05/bin/python', 'LD_LIBRARY_PATH': '/home/ya255/cuda-11.8/lib64', 'SLURM_JOB_ID': '5887989', 'SLURM_NODEID': '0', 'SLURM_STEP_NUM_NODES': '1', 'SSH_CLIENT': '10.41.244.132 38532 22', 'CONDA_DEFAULT_ENV': 'lingua_241023', 'SLURM_STEP_TASKS_PER_NODE': '3', 'CUDA_HOME': '/home/ya255/cuda-11.8', 'SLURM_CONF': '/usr/local/slurm/slurm-22.05.8/etc/slurm.conf', 'PATH': '/home/ya255/cuda-11.8/bin:/home/ya255/cuda-12.1/bin:/home/ya255/.local/bin:/home/ya255/.conda/envs/lingua_241023/bin:/home/ya255/.local/bin:/home/ya255/cuda-11.8/bin:/home/ya255/cuda-12.1/bin:/home/ya255/.local/bin:/share/apps/anaconda3/2021.05/bin:/usr/local/slurm/current/bin:/usr/local/slurm/current/sbin:/usr/local/openmpi/current/bin:/usr/local/openmpi/current:/usr/local/slurm/current/bin:/usr/local/slurm/current/sbin:/usr/local/openmpi/current/bin:/usr/local/openmpi/current:/home/ya255/.local/bin:/home/ya255/cuda-11.8/bin:/home/ya255/cuda-12.1/bin:/home/ya255/.local/bin:/share/apps/anaconda3/2021.05/bin:/share/apps/anaconda3/2021.05/condabin:/share/apps/anaconda3/2021.05/bin:/usr/local/slurm/current/bin:/usr/local/slurm/current/sbin:/usr/local/openmpi/current/bin:/usr/local/openmpi/current:/usr/local/slurm/current/bin:/usr/local/slurm/current/sbin:/usr/local/openmpi/current/bin:/usr/local/openmpi/current:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin', 'SLURM_JOB_NAME': 'bash', 'MODULEPATH': '/etc/environment-modules/modules:/usr/share/modules/versions:/usr/share/modules/$MODULE_VERSION/modulefiles:/usr/share/modules/modulefiles', 'SSH_TTY': '/dev/pts/155', 'CONDA_PREFIX_1': '/share/apps/anaconda3/2021.05', 'SLURM_STEP_LAUNCHER_PORT': '62271', 'SLURM_JOB_GID': '1658701', 'SLURM_JOB_NODELIST': 'abdelfattah-compute-03', 'MODULES_CMD': '/usr/lib/x86_64-linux-gnu/modulecmd.tcl', 'BASH_FUNC_switchml%%': '() {  typeset swfound=1;\n if [ "${MODULES_USE_COMPAT_VERSION:-0}" = \'1\' ]; then\n typeset swname=\'main\';\n if [ -e /usr/lib/x86_64-linux-gnu/modulecmd.tcl ]; then\n typeset swfound=0;\n unset MODULES_USE_COMPAT_VERSION;\n fi;\n else\n typeset swname=\'compatibility\';\n if [ -e /usr/lib/x86_64-linux-gnu/modulecmd-compat ]; then\n typeset swfound=0;\n MODULES_USE_COMPAT_VERSION=1;\n export MODULES_USE_COMPAT_VERSION;\n fi;\n fi;\n if [ $swfound -eq 0 ]; then\n echo "Switching to Modules $swname version";\n source /usr/share/modules/init/bash;\n else\n echo "Cannot switch to Modules $swname version, command not found";\n return 1;\n fi\n}', 'BASH_FUNC_module%%': '() {  _module_raw "$@" 2>&1\n}', 'BASH_FUNC__module_raw%%': '() {  unset _mlshdbg;\n if [ "${MODULES_SILENT_SHELL_DEBUG:-0}" = \'1\' ]; then\n case "$-" in \n *v*x*)\n set +vx;\n _mlshdbg=\'vx\'\n ;;\n *v*)\n set +v;\n _mlshdbg=\'v\'\n ;;\n *x*)\n set +x;\n _mlshdbg=\'x\'\n ;;\n *)\n _mlshdbg=\'\'\n ;;\n esac;\n fi;\n unset _mlre _mlIFS;\n if [ -n "${IFS+x}" ]; then\n _mlIFS=$IFS;\n fi;\n IFS=\' \';\n for _mlv in ${MODULES_RUN_QUARANTINE:-};\n do\n if [ "${_mlv}" = "${_mlv##*[!A-Za-z0-9_]}" -a "${_mlv}" = "${_mlv#[0-9]}" ]; then\n if [ -n "`eval \'echo ${\'$_mlv\'+x}\'`" ]; then\n _mlre="${_mlre:-}${_mlv}_modquar=\'`eval \'echo ${\'$_mlv\'}\'`\' ";\n fi;\n _mlrv="MODULES_RUNENV_${_mlv}";\n _mlre="${_mlre:-}${_mlv}=\'`eval \'echo ${\'$_mlrv\':-}\'`\' ";\n fi;\n done;\n if [ -n "${_mlre:-}" ]; then\n eval `eval ${_mlre}/usr/bin/tclsh8.6 /usr/lib/x86_64-linux-gnu/modulecmd.tcl bash \'"$@"\'`;\n else\n eval `/usr/bin/tclsh8.6 /usr/lib/x86_64-linux-gnu/modulecmd.tcl bash "$@"`;\n fi;\n _mlstatus=$?;\n if [ -n "${_mlIFS+x}" ]; then\n IFS=$_mlIFS;\n else\n unset IFS;\n fi;\n unset _mlre _mlv _mlrv _mlIFS;\n if [ -n "${_mlshdbg:-}" ]; then\n set -$_mlshdbg;\n fi;\n unset _mlshdbg;\n return $_mlstatus\n}', 'OLDPWD': '/home/ya255', '_': '/home/ya255/.conda/envs/lingua_241023/bin/torchrun', 'LOCAL_RANK': '0', 'RANK': '0', 'GROUP_RANK': '0', 'ROLE_RANK': '0', 'ROLE_NAME': 'default', 'LOCAL_WORLD_SIZE': '1', 'WORLD_SIZE': '1', 'GROUP_WORLD_SIZE': '1', 'ROLE_WORLD_SIZE': '1', 'MASTER_ADDR': '127.0.0.1', 'MASTER_PORT': '29506', 'TORCHELASTIC_RESTART_COUNT': '0', 'TORCHELASTIC_MAX_RESTARTS': '0', 'TORCHELASTIC_RUN_ID': 'none', 'TORCHELASTIC_USE_AGENT_STORE': 'True', 'TORCH_NCCL_ASYNC_ERROR_HANDLING': '1', 'TORCHELASTIC_ERROR_FILE': '/scratch/ya255/tmp/torchelastic_gpo2m4w3/none_dx0c1ak1/attempt_0/0/error.json', 'CUDA_MODULE_LOADING': 'LAZY', 'MKL_SERVICE_FORCE_INTEL': 'GNU', 'OMP_NUM_THREADS': '1', 'MKL_NUM_THREADS': '1', 'ENABLE_INTRA_NODE_COMM': '1', 'TORCH_NCCL_AVOID_RECORD_STREAMS': '1', 'NCCL_IB_TIMEOUT': '22', 'NCCL_DEBUG': 'INFO', 'TRITON_CACHE_DIR': '/scratch/ya255/tmp/tmptw5rni91'})
0: INFO    24-11-16 15:41:34.444203 - 0:00:05 - Starting job: xmer_60k_dclm_65M
0: INFO    24-11-16 15:41:34.444454 - 0:00:05 - Running on dp rank : 0
0: INFO    24-11-16 15:41:34.444540 - 0:00:05 - Running on dp size : 1
0: INFO    24-11-16 15:41:34.446198 - 0:00:05 - Building model
0: INFO    24-11-16 15:41:34.499222 - 0:00:05 - Model is built !
0: INFO    24-11-16 15:41:36.536343 - 0:00:07 - Model size: 53,221,888 total parameters
0: INFO    24-11-16 15:41:36.537051 - 0:00:07 - GPU capacity: NVIDIA RTX A6000 (0) with 47.54GiB memory
0: INFO    24-11-16 15:41:36.538425 - 0:00:07 - GPU memory usage: NVIDIA RTX A6000 (0): 47.535888671875 GiB capacity, 0.291015625 GiB peak, 0.6122019239164488% peak
0: INFO    24-11-16 15:41:36.538499 - 0:00:07 - Starting build of optimizer...
0: INFO    24-11-16 15:41:36.538894 - 0:00:07 - Done with build of optimizer.
0: INFO    24-11-16 15:41:36.540836 - 0:00:07 - Async dataloader started
0: INFO    24-11-16 15:41:36.541847 - 0:00:07 - Profiling active.  Traces will be saved at /scratch/ya255/lingua/reported_runs/xmer_60k_dclm_65M/profiling
0: INFO    24-11-16 15:41:36.542073 - 0:00:07 - Starting MemSnapshotsProfilerWandb profiler...
0: INFO    24-11-16 15:41:39.032812 - 0:00:09 - Async data process 3001382 exited with code 1
0: INFO    24-11-16 15:41:39.032950 - 0:00:09 - Async dataloader cleaned up
0: WARNING 24-11-16 15:41:51.803244 - 0:00:00 - Signal handler installed.
0: WARNING 24-11-16 15:41:51.803586 - 0:00:00 - WARNING: Setting MKL_SERVICE_FORCE_INTEL to GNU
0: WARNING 24-11-16 15:41:51.803681 - 0:00:00 - WARNING: Setting OMP_NUM_THREADS to 1
0: WARNING 24-11-16 15:41:51.803776 - 0:00:00 - WARNING: Setting MKL_NUM_THREADS to 1
0: WARNING 24-11-16 15:41:51.803839 - 0:00:00 - WARNING: Setting ENABLE_INTRA_NODE_COMM to 1
0: WARNING 24-11-16 15:41:51.803890 - 0:00:00 - WARNING: Setting TORCH_NCCL_AVOID_RECORD_STREAMS to 1
0: WARNING 24-11-16 15:41:51.803939 - 0:00:00 - WARNING: Setting NCCL_IB_TIMEOUT to 22
0: WARNING 24-11-16 15:41:51.803984 - 0:00:00 - WARNING: Setting NCCL_DEBUG to INFO
0: WARNING 24-11-16 15:41:51.804037 - 0:00:00 - WARNING: Setting TRITON_CACHE_DIR to /scratch/ya255/tmp/tmpc0hi45jw
0: INFO    24-11-16 15:41:56.375414 - 0:00:05 - Run launched with torchrun, local rank: 0
0: INFO    24-11-16 15:41:56.375718 - 0:00:05 - ENV: environ({'SHELL': '/bin/bash', 'SLURM_STEP_NUM_TASKS': '3', 'SLURM_JOB_USER': 'ya255', 'SLURM_TASKS_PER_NODE': '3', 'SLURM_JOB_UID': '1642556', 'SLURM_STEP_GPUS': '0', 'SLURM_CPU_BIND': 'quiet,mask_cpu:0x0000000000000001,0x0000000000000004,0x0000000000000008', 'SLURM_TASK_PID': '2950149', 'CONDA_EXE': '/share/apps/anaconda3/2021.05/bin/conda', '_CE_M': '', 'TMUX': '/tmp/tmux-1642556/default,2233183,4', 'SLURM_LOCALID': '0', 'SLURM_SUBMIT_DIR': '/home/ya255', 'SLURM_CPU_BIND_VERBOSE': 'quiet', 'SLURMD_NODENAME': 'abdelfattah-compute-03', 'SLURM_STEP_NODELIST': 'abdelfattah-compute-03', 'SLURM_CLUSTER_NAME': 'g2', 'SLURM_CPUS_ON_NODE': '3', 'SLURM_UMASK': '0002', 'SLURM_JOB_CPUS_PER_NODE': '3', 'ENV': '/usr/share/modules/init/profile.sh', 'SLURM_GPUS_ON_NODE': '1', 'KRB5CCNAME': 'FILE:/tmp/krb5cc_1642556_HhGMYr', 'PWD': '/scratch/ya255/lingua', 'SLURM_GTIDS': '0,1,2', 'LOGNAME': 'ya255', 'CONDA_PREFIX': '/home/ya255/.conda/envs/lingua_241023', 'SLURM_JOB_PARTITION': 'abdelfattah-interactive', 'MODULESHOME': '/usr/share/modules', 'MANPATH': ':', 'ROCR_VISIBLE_DEVICES': '0', 'SLURM_JOB_NUM_NODES': '1', 'SRUN_DEBUG': '3', 'SLURM_STEPID': '0', 'SLURM_CPU_BIND_LIST': '0x0000000000000001,0x0000000000000004,0x0000000000000008', 'SLURM_JOBID': '5887989', 'SLURM_PTY_PORT': '62270', 'SLURM_LAUNCH_NODE_IPADDR': '128.84.101.4', 'SLURM_JOB_QOS': 'normal', 'MOTD_SHOWN': 'pam', 'SLURM_PTY_WIN_ROW': '14', 'HOME': '/home/ya255', 'LANG': 'en_US.UTF-8', 'SLURM_CPU_BIND_TYPE': 'mask_cpu:', 'LS_COLORS': 'rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:', 'SLURM_PROCID': '0', 'CONDA_PROMPT_MODIFIER': '(lingua_241023) ', 'TMPDIR': '/scratch/ya255/tmp', 'SLURM_NTASKS': '3', 'SLURM_TOPOLOGY_ADDR': 'abdelfattah-compute-03', 'SSH_CONNECTION': '10.41.228.20 49376 128.84.101.4 22', 'SLURM_DISTRIBUTION': 'block,pack', 'ZE_AFFINITY_MASK': '0', 'SLURM_TOPOLOGY_ADDR_PATTERN': 'node', 'CUDA_VISIBLE_DEVICES': '0', 'SLURM_SRUN_COMM_HOST': '128.84.101.4', 'HF_HOME': '/scratch/ya255/huggingface', 'LESSCLOSE': '/usr/bin/lesspipe %s %s', 'MODULEPATH_modshare': '/etc/environment-modules/modules:1:/usr/share/modules/$MODULE_VERSION/modulefiles:1:/usr/share/modules/modulefiles:1:/usr/share/modules/versions:1', 'SLURM_WORKING_CLUSTER': 'g2:slurmctld:6817:9728:109', 'TERM': 'screen', '_CE_CONDA': '', 'SLURM_PTY_WIN_COL': '248', 'LESSOPEN': '| /usr/bin/lesspipe %s', 'USER': 'ya255', 'TMUX_PANE': '%25', 'SLURM_NODELIST': 'abdelfattah-compute-03', 'GPU_DEVICE_ORDINAL': '0', 'CONDA_SHLVL': '2', 'SLURM_SRUN_COMM_PORT': '62271', 'LOADEDMODULES': '', 'SLURM_STEP_ID': '0', 'SLURM_JOB_ACCOUNT': 'abdelfattah', 'SLURM_PRIO_PROCESS': '0', 'SLURM_NPROCS': '3', 'SHLVL': '3', 'SLURM_NNODES': '1', 'BASH_ENV': '/usr/share/modules/init/bash', 'SLURM_SUBMIT_HOST': 'g2-login-05.coecis.cornell.edu', 'CONDA_PYTHON_EXE': '/share/apps/anaconda3/2021.05/bin/python', 'LD_LIBRARY_PATH': '/home/ya255/cuda-11.8/lib64', 'SLURM_JOB_ID': '5887989', 'SLURM_NODEID': '0', 'SLURM_STEP_NUM_NODES': '1', 'SSH_CLIENT': '10.41.244.132 38532 22', 'CONDA_DEFAULT_ENV': 'lingua_241023', 'SLURM_STEP_TASKS_PER_NODE': '3', 'CUDA_HOME': '/home/ya255/cuda-11.8', 'SLURM_CONF': '/usr/local/slurm/slurm-22.05.8/etc/slurm.conf', 'PATH': '/home/ya255/cuda-11.8/bin:/home/ya255/cuda-12.1/bin:/home/ya255/.local/bin:/home/ya255/.conda/envs/lingua_241023/bin:/home/ya255/.local/bin:/home/ya255/cuda-11.8/bin:/home/ya255/cuda-12.1/bin:/home/ya255/.local/bin:/share/apps/anaconda3/2021.05/bin:/usr/local/slurm/current/bin:/usr/local/slurm/current/sbin:/usr/local/openmpi/current/bin:/usr/local/openmpi/current:/usr/local/slurm/current/bin:/usr/local/slurm/current/sbin:/usr/local/openmpi/current/bin:/usr/local/openmpi/current:/home/ya255/.local/bin:/home/ya255/cuda-11.8/bin:/home/ya255/cuda-12.1/bin:/home/ya255/.local/bin:/share/apps/anaconda3/2021.05/bin:/share/apps/anaconda3/2021.05/condabin:/share/apps/anaconda3/2021.05/bin:/usr/local/slurm/current/bin:/usr/local/slurm/current/sbin:/usr/local/openmpi/current/bin:/usr/local/openmpi/current:/usr/local/slurm/current/bin:/usr/local/slurm/current/sbin:/usr/local/openmpi/current/bin:/usr/local/openmpi/current:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin', 'SLURM_JOB_NAME': 'bash', 'MODULEPATH': '/etc/environment-modules/modules:/usr/share/modules/versions:/usr/share/modules/$MODULE_VERSION/modulefiles:/usr/share/modules/modulefiles', 'SSH_TTY': '/dev/pts/155', 'CONDA_PREFIX_1': '/share/apps/anaconda3/2021.05', 'SLURM_STEP_LAUNCHER_PORT': '62271', 'SLURM_JOB_GID': '1658701', 'SLURM_JOB_NODELIST': 'abdelfattah-compute-03', 'MODULES_CMD': '/usr/lib/x86_64-linux-gnu/modulecmd.tcl', 'BASH_FUNC_switchml%%': '() {  typeset swfound=1;\n if [ "${MODULES_USE_COMPAT_VERSION:-0}" = \'1\' ]; then\n typeset swname=\'main\';\n if [ -e /usr/lib/x86_64-linux-gnu/modulecmd.tcl ]; then\n typeset swfound=0;\n unset MODULES_USE_COMPAT_VERSION;\n fi;\n else\n typeset swname=\'compatibility\';\n if [ -e /usr/lib/x86_64-linux-gnu/modulecmd-compat ]; then\n typeset swfound=0;\n MODULES_USE_COMPAT_VERSION=1;\n export MODULES_USE_COMPAT_VERSION;\n fi;\n fi;\n if [ $swfound -eq 0 ]; then\n echo "Switching to Modules $swname version";\n source /usr/share/modules/init/bash;\n else\n echo "Cannot switch to Modules $swname version, command not found";\n return 1;\n fi\n}', 'BASH_FUNC_module%%': '() {  _module_raw "$@" 2>&1\n}', 'BASH_FUNC__module_raw%%': '() {  unset _mlshdbg;\n if [ "${MODULES_SILENT_SHELL_DEBUG:-0}" = \'1\' ]; then\n case "$-" in \n *v*x*)\n set +vx;\n _mlshdbg=\'vx\'\n ;;\n *v*)\n set +v;\n _mlshdbg=\'v\'\n ;;\n *x*)\n set +x;\n _mlshdbg=\'x\'\n ;;\n *)\n _mlshdbg=\'\'\n ;;\n esac;\n fi;\n unset _mlre _mlIFS;\n if [ -n "${IFS+x}" ]; then\n _mlIFS=$IFS;\n fi;\n IFS=\' \';\n for _mlv in ${MODULES_RUN_QUARANTINE:-};\n do\n if [ "${_mlv}" = "${_mlv##*[!A-Za-z0-9_]}" -a "${_mlv}" = "${_mlv#[0-9]}" ]; then\n if [ -n "`eval \'echo ${\'$_mlv\'+x}\'`" ]; then\n _mlre="${_mlre:-}${_mlv}_modquar=\'`eval \'echo ${\'$_mlv\'}\'`\' ";\n fi;\n _mlrv="MODULES_RUNENV_${_mlv}";\n _mlre="${_mlre:-}${_mlv}=\'`eval \'echo ${\'$_mlrv\':-}\'`\' ";\n fi;\n done;\n if [ -n "${_mlre:-}" ]; then\n eval `eval ${_mlre}/usr/bin/tclsh8.6 /usr/lib/x86_64-linux-gnu/modulecmd.tcl bash \'"$@"\'`;\n else\n eval `/usr/bin/tclsh8.6 /usr/lib/x86_64-linux-gnu/modulecmd.tcl bash "$@"`;\n fi;\n _mlstatus=$?;\n if [ -n "${_mlIFS+x}" ]; then\n IFS=$_mlIFS;\n else\n unset IFS;\n fi;\n unset _mlre _mlv _mlrv _mlIFS;\n if [ -n "${_mlshdbg:-}" ]; then\n set -$_mlshdbg;\n fi;\n unset _mlshdbg;\n return $_mlstatus\n}', 'OLDPWD': '/home/ya255', '_': '/home/ya255/.conda/envs/lingua_241023/bin/torchrun', 'LOCAL_RANK': '0', 'RANK': '0', 'GROUP_RANK': '0', 'ROLE_RANK': '0', 'ROLE_NAME': 'default', 'LOCAL_WORLD_SIZE': '1', 'WORLD_SIZE': '1', 'GROUP_WORLD_SIZE': '1', 'ROLE_WORLD_SIZE': '1', 'MASTER_ADDR': '127.0.0.1', 'MASTER_PORT': '29506', 'TORCHELASTIC_RESTART_COUNT': '0', 'TORCHELASTIC_MAX_RESTARTS': '0', 'TORCHELASTIC_RUN_ID': 'none', 'TORCHELASTIC_USE_AGENT_STORE': 'True', 'TORCH_NCCL_ASYNC_ERROR_HANDLING': '1', 'TORCHELASTIC_ERROR_FILE': '/scratch/ya255/tmp/torchelastic_lnats8yb/none__bpdt0p7/attempt_0/0/error.json', 'CUDA_MODULE_LOADING': 'LAZY', 'MKL_SERVICE_FORCE_INTEL': 'GNU', 'OMP_NUM_THREADS': '1', 'MKL_NUM_THREADS': '1', 'ENABLE_INTRA_NODE_COMM': '1', 'TORCH_NCCL_AVOID_RECORD_STREAMS': '1', 'NCCL_IB_TIMEOUT': '22', 'NCCL_DEBUG': 'INFO', 'TRITON_CACHE_DIR': '/scratch/ya255/tmp/tmpc0hi45jw'})
0: INFO    24-11-16 15:41:56.408009 - 0:00:05 - Starting job: xmer_60k_dclm_65M
0: INFO    24-11-16 15:41:56.408274 - 0:00:05 - Running on dp rank : 0
0: INFO    24-11-16 15:41:56.408369 - 0:00:05 - Running on dp size : 1
0: INFO    24-11-16 15:41:56.410036 - 0:00:05 - Building model
0: INFO    24-11-16 15:41:56.470564 - 0:00:05 - Model is built !
0: INFO    24-11-16 15:41:58.469951 - 0:00:07 - Model size: 56,630,784 total parameters
0: INFO    24-11-16 15:41:58.470699 - 0:00:07 - GPU capacity: NVIDIA RTX A6000 (0) with 47.54GiB memory
0: INFO    24-11-16 15:41:58.472376 - 0:00:07 - GPU memory usage: NVIDIA RTX A6000 (0): 47.535888671875 GiB capacity, 0.310546875 GiB peak, 0.6532893013605058% peak
0: INFO    24-11-16 15:41:58.472459 - 0:00:07 - Starting build of optimizer...
0: INFO    24-11-16 15:41:58.472938 - 0:00:07 - Done with build of optimizer.
0: INFO    24-11-16 15:41:58.475072 - 0:00:07 - Async dataloader started
0: INFO    24-11-16 15:41:58.476108 - 0:00:07 - Profiling active.  Traces will be saved at /scratch/ya255/lingua/reported_runs/xmer_60k_dclm_65M/profiling
0: INFO    24-11-16 15:41:58.476342 - 0:00:07 - Starting MemSnapshotsProfilerWandb profiler...
0: INFO    24-11-16 15:42:02.093692 - 0:00:10 - Async data process 3001469 exited with code 1
0: INFO    24-11-16 15:42:02.093847 - 0:00:10 - Async dataloader cleaned up
0: WARNING 24-11-16 15:42:31.488464 - 0:00:00 - Signal handler installed.
0: WARNING 24-11-16 15:42:31.488785 - 0:00:00 - WARNING: Setting MKL_SERVICE_FORCE_INTEL to GNU
0: WARNING 24-11-16 15:42:31.488872 - 0:00:00 - WARNING: Setting OMP_NUM_THREADS to 1
0: WARNING 24-11-16 15:42:31.488965 - 0:00:00 - WARNING: Setting MKL_NUM_THREADS to 1
0: WARNING 24-11-16 15:42:31.489032 - 0:00:00 - WARNING: Setting ENABLE_INTRA_NODE_COMM to 1
0: WARNING 24-11-16 15:42:31.489099 - 0:00:00 - WARNING: Setting TORCH_NCCL_AVOID_RECORD_STREAMS to 1
0: WARNING 24-11-16 15:42:31.489165 - 0:00:00 - WARNING: Setting NCCL_IB_TIMEOUT to 22
0: WARNING 24-11-16 15:42:31.489217 - 0:00:00 - WARNING: Setting NCCL_DEBUG to INFO
0: WARNING 24-11-16 15:42:31.489270 - 0:00:00 - WARNING: Setting TRITON_CACHE_DIR to /scratch/ya255/tmp/tmp9b2yrjkp
0: INFO    24-11-16 15:42:36.062836 - 0:00:05 - Run launched with torchrun, local rank: 0
0: INFO    24-11-16 15:42:36.063129 - 0:00:05 - ENV: environ({'SHELL': '/bin/bash', 'SLURM_STEP_NUM_TASKS': '3', 'SLURM_JOB_USER': 'ya255', 'SLURM_TASKS_PER_NODE': '3', 'SLURM_JOB_UID': '1642556', 'SLURM_STEP_GPUS': '0', 'SLURM_CPU_BIND': 'quiet,mask_cpu:0x0000000000000001,0x0000000000000004,0x0000000000000008', 'SLURM_TASK_PID': '2950149', 'CONDA_EXE': '/share/apps/anaconda3/2021.05/bin/conda', '_CE_M': '', 'TMUX': '/tmp/tmux-1642556/default,2233183,4', 'SLURM_LOCALID': '0', 'SLURM_SUBMIT_DIR': '/home/ya255', 'SLURM_CPU_BIND_VERBOSE': 'quiet', 'SLURMD_NODENAME': 'abdelfattah-compute-03', 'SLURM_STEP_NODELIST': 'abdelfattah-compute-03', 'SLURM_CLUSTER_NAME': 'g2', 'SLURM_CPUS_ON_NODE': '3', 'SLURM_UMASK': '0002', 'SLURM_JOB_CPUS_PER_NODE': '3', 'ENV': '/usr/share/modules/init/profile.sh', 'SLURM_GPUS_ON_NODE': '1', 'KRB5CCNAME': 'FILE:/tmp/krb5cc_1642556_HhGMYr', 'PWD': '/scratch/ya255/lingua', 'SLURM_GTIDS': '0,1,2', 'LOGNAME': 'ya255', 'CONDA_PREFIX': '/home/ya255/.conda/envs/lingua_241023', 'SLURM_JOB_PARTITION': 'abdelfattah-interactive', 'MODULESHOME': '/usr/share/modules', 'MANPATH': ':', 'ROCR_VISIBLE_DEVICES': '0', 'SLURM_JOB_NUM_NODES': '1', 'SRUN_DEBUG': '3', 'SLURM_STEPID': '0', 'SLURM_CPU_BIND_LIST': '0x0000000000000001,0x0000000000000004,0x0000000000000008', 'SLURM_JOBID': '5887989', 'SLURM_PTY_PORT': '62270', 'SLURM_LAUNCH_NODE_IPADDR': '128.84.101.4', 'SLURM_JOB_QOS': 'normal', 'MOTD_SHOWN': 'pam', 'SLURM_PTY_WIN_ROW': '14', 'HOME': '/home/ya255', 'LANG': 'en_US.UTF-8', 'SLURM_CPU_BIND_TYPE': 'mask_cpu:', 'LS_COLORS': 'rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:', 'SLURM_PROCID': '0', 'CONDA_PROMPT_MODIFIER': '(lingua_241023) ', 'TMPDIR': '/scratch/ya255/tmp', 'SLURM_NTASKS': '3', 'SLURM_TOPOLOGY_ADDR': 'abdelfattah-compute-03', 'SSH_CONNECTION': '10.41.228.20 49376 128.84.101.4 22', 'SLURM_DISTRIBUTION': 'block,pack', 'ZE_AFFINITY_MASK': '0', 'SLURM_TOPOLOGY_ADDR_PATTERN': 'node', 'CUDA_VISIBLE_DEVICES': '0', 'SLURM_SRUN_COMM_HOST': '128.84.101.4', 'HF_HOME': '/scratch/ya255/huggingface', 'LESSCLOSE': '/usr/bin/lesspipe %s %s', 'MODULEPATH_modshare': '/etc/environment-modules/modules:1:/usr/share/modules/$MODULE_VERSION/modulefiles:1:/usr/share/modules/modulefiles:1:/usr/share/modules/versions:1', 'SLURM_WORKING_CLUSTER': 'g2:slurmctld:6817:9728:109', 'TERM': 'screen', '_CE_CONDA': '', 'SLURM_PTY_WIN_COL': '248', 'LESSOPEN': '| /usr/bin/lesspipe %s', 'USER': 'ya255', 'TMUX_PANE': '%25', 'SLURM_NODELIST': 'abdelfattah-compute-03', 'GPU_DEVICE_ORDINAL': '0', 'CONDA_SHLVL': '2', 'SLURM_SRUN_COMM_PORT': '62271', 'LOADEDMODULES': '', 'SLURM_STEP_ID': '0', 'SLURM_JOB_ACCOUNT': 'abdelfattah', 'SLURM_PRIO_PROCESS': '0', 'SLURM_NPROCS': '3', 'SHLVL': '3', 'SLURM_NNODES': '1', 'BASH_ENV': '/usr/share/modules/init/bash', 'SLURM_SUBMIT_HOST': 'g2-login-05.coecis.cornell.edu', 'CONDA_PYTHON_EXE': '/share/apps/anaconda3/2021.05/bin/python', 'LD_LIBRARY_PATH': '/home/ya255/cuda-11.8/lib64', 'SLURM_JOB_ID': '5887989', 'SLURM_NODEID': '0', 'SLURM_STEP_NUM_NODES': '1', 'SSH_CLIENT': '10.41.244.132 38532 22', 'CONDA_DEFAULT_ENV': 'lingua_241023', 'SLURM_STEP_TASKS_PER_NODE': '3', 'CUDA_HOME': '/home/ya255/cuda-11.8', 'SLURM_CONF': '/usr/local/slurm/slurm-22.05.8/etc/slurm.conf', 'PATH': '/home/ya255/cuda-11.8/bin:/home/ya255/cuda-12.1/bin:/home/ya255/.local/bin:/home/ya255/.conda/envs/lingua_241023/bin:/home/ya255/.local/bin:/home/ya255/cuda-11.8/bin:/home/ya255/cuda-12.1/bin:/home/ya255/.local/bin:/share/apps/anaconda3/2021.05/bin:/usr/local/slurm/current/bin:/usr/local/slurm/current/sbin:/usr/local/openmpi/current/bin:/usr/local/openmpi/current:/usr/local/slurm/current/bin:/usr/local/slurm/current/sbin:/usr/local/openmpi/current/bin:/usr/local/openmpi/current:/home/ya255/.local/bin:/home/ya255/cuda-11.8/bin:/home/ya255/cuda-12.1/bin:/home/ya255/.local/bin:/share/apps/anaconda3/2021.05/bin:/share/apps/anaconda3/2021.05/condabin:/share/apps/anaconda3/2021.05/bin:/usr/local/slurm/current/bin:/usr/local/slurm/current/sbin:/usr/local/openmpi/current/bin:/usr/local/openmpi/current:/usr/local/slurm/current/bin:/usr/local/slurm/current/sbin:/usr/local/openmpi/current/bin:/usr/local/openmpi/current:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin', 'SLURM_JOB_NAME': 'bash', 'MODULEPATH': '/etc/environment-modules/modules:/usr/share/modules/versions:/usr/share/modules/$MODULE_VERSION/modulefiles:/usr/share/modules/modulefiles', 'SSH_TTY': '/dev/pts/155', 'CONDA_PREFIX_1': '/share/apps/anaconda3/2021.05', 'SLURM_STEP_LAUNCHER_PORT': '62271', 'SLURM_JOB_GID': '1658701', 'SLURM_JOB_NODELIST': 'abdelfattah-compute-03', 'MODULES_CMD': '/usr/lib/x86_64-linux-gnu/modulecmd.tcl', 'BASH_FUNC_switchml%%': '() {  typeset swfound=1;\n if [ "${MODULES_USE_COMPAT_VERSION:-0}" = \'1\' ]; then\n typeset swname=\'main\';\n if [ -e /usr/lib/x86_64-linux-gnu/modulecmd.tcl ]; then\n typeset swfound=0;\n unset MODULES_USE_COMPAT_VERSION;\n fi;\n else\n typeset swname=\'compatibility\';\n if [ -e /usr/lib/x86_64-linux-gnu/modulecmd-compat ]; then\n typeset swfound=0;\n MODULES_USE_COMPAT_VERSION=1;\n export MODULES_USE_COMPAT_VERSION;\n fi;\n fi;\n if [ $swfound -eq 0 ]; then\n echo "Switching to Modules $swname version";\n source /usr/share/modules/init/bash;\n else\n echo "Cannot switch to Modules $swname version, command not found";\n return 1;\n fi\n}', 'BASH_FUNC_module%%': '() {  _module_raw "$@" 2>&1\n}', 'BASH_FUNC__module_raw%%': '() {  unset _mlshdbg;\n if [ "${MODULES_SILENT_SHELL_DEBUG:-0}" = \'1\' ]; then\n case "$-" in \n *v*x*)\n set +vx;\n _mlshdbg=\'vx\'\n ;;\n *v*)\n set +v;\n _mlshdbg=\'v\'\n ;;\n *x*)\n set +x;\n _mlshdbg=\'x\'\n ;;\n *)\n _mlshdbg=\'\'\n ;;\n esac;\n fi;\n unset _mlre _mlIFS;\n if [ -n "${IFS+x}" ]; then\n _mlIFS=$IFS;\n fi;\n IFS=\' \';\n for _mlv in ${MODULES_RUN_QUARANTINE:-};\n do\n if [ "${_mlv}" = "${_mlv##*[!A-Za-z0-9_]}" -a "${_mlv}" = "${_mlv#[0-9]}" ]; then\n if [ -n "`eval \'echo ${\'$_mlv\'+x}\'`" ]; then\n _mlre="${_mlre:-}${_mlv}_modquar=\'`eval \'echo ${\'$_mlv\'}\'`\' ";\n fi;\n _mlrv="MODULES_RUNENV_${_mlv}";\n _mlre="${_mlre:-}${_mlv}=\'`eval \'echo ${\'$_mlrv\':-}\'`\' ";\n fi;\n done;\n if [ -n "${_mlre:-}" ]; then\n eval `eval ${_mlre}/usr/bin/tclsh8.6 /usr/lib/x86_64-linux-gnu/modulecmd.tcl bash \'"$@"\'`;\n else\n eval `/usr/bin/tclsh8.6 /usr/lib/x86_64-linux-gnu/modulecmd.tcl bash "$@"`;\n fi;\n _mlstatus=$?;\n if [ -n "${_mlIFS+x}" ]; then\n IFS=$_mlIFS;\n else\n unset IFS;\n fi;\n unset _mlre _mlv _mlrv _mlIFS;\n if [ -n "${_mlshdbg:-}" ]; then\n set -$_mlshdbg;\n fi;\n unset _mlshdbg;\n return $_mlstatus\n}', 'OLDPWD': '/home/ya255', '_': '/home/ya255/.conda/envs/lingua_241023/bin/torchrun', 'LOCAL_RANK': '0', 'RANK': '0', 'GROUP_RANK': '0', 'ROLE_RANK': '0', 'ROLE_NAME': 'default', 'LOCAL_WORLD_SIZE': '1', 'WORLD_SIZE': '1', 'GROUP_WORLD_SIZE': '1', 'ROLE_WORLD_SIZE': '1', 'MASTER_ADDR': '127.0.0.1', 'MASTER_PORT': '29506', 'TORCHELASTIC_RESTART_COUNT': '0', 'TORCHELASTIC_MAX_RESTARTS': '0', 'TORCHELASTIC_RUN_ID': 'none', 'TORCHELASTIC_USE_AGENT_STORE': 'True', 'TORCH_NCCL_ASYNC_ERROR_HANDLING': '1', 'TORCHELASTIC_ERROR_FILE': '/scratch/ya255/tmp/torchelastic_a6or2t51/none_sfdzo_ze/attempt_0/0/error.json', 'CUDA_MODULE_LOADING': 'LAZY', 'MKL_SERVICE_FORCE_INTEL': 'GNU', 'OMP_NUM_THREADS': '1', 'MKL_NUM_THREADS': '1', 'ENABLE_INTRA_NODE_COMM': '1', 'TORCH_NCCL_AVOID_RECORD_STREAMS': '1', 'NCCL_IB_TIMEOUT': '22', 'NCCL_DEBUG': 'INFO', 'TRITON_CACHE_DIR': '/scratch/ya255/tmp/tmp9b2yrjkp'})
0: INFO    24-11-16 15:42:36.091836 - 0:00:05 - Starting job: xmer_60k_dclm_65M
0: INFO    24-11-16 15:42:36.092070 - 0:00:05 - Running on dp rank : 0
0: INFO    24-11-16 15:42:36.092155 - 0:00:05 - Running on dp size : 1
0: INFO    24-11-16 15:42:36.093700 - 0:00:05 - Building model
0: INFO    24-11-16 15:42:36.139514 - 0:00:05 - Model is built !
0: INFO    24-11-16 15:42:38.022700 - 0:00:07 - Model size: 129,772,544 total parameters
0: INFO    24-11-16 15:42:38.023676 - 0:00:07 - GPU capacity: NVIDIA RTX A6000 (0) with 47.54GiB memory
0: INFO    24-11-16 15:42:38.025090 - 0:00:07 - GPU memory usage: NVIDIA RTX A6000 (0): 47.535888671875 GiB capacity, 0.677734375 GiB peak, 1.4257319973087768% peak
0: INFO    24-11-16 15:42:38.025171 - 0:00:07 - Starting build of optimizer...
0: INFO    24-11-16 15:42:38.025631 - 0:00:07 - Done with build of optimizer.
0: INFO    24-11-16 15:42:38.027652 - 0:00:07 - Async dataloader started
0: INFO    24-11-16 15:42:38.028655 - 0:00:07 - Profiling active.  Traces will be saved at /scratch/ya255/lingua/reported_runs/xmer_60k_dclm_65M/profiling
0: INFO    24-11-16 15:42:38.028916 - 0:00:07 - Starting MemSnapshotsProfilerWandb profiler...
0: INFO    24-11-16 15:42:57.126140 - 0:00:26 - garbage collection
0: INFO    24-11-16 15:43:01.540650 - 0:00:30 - Killing async data process 3001829 ...
0: INFO    24-11-16 15:43:01.554379 - 0:00:30 - Async dataloader cleaned up
0: WARNING 24-11-16 15:43:39.011416 - 0:00:00 - Signal handler installed.
0: WARNING 24-11-16 15:43:39.011738 - 0:00:00 - WARNING: Setting MKL_SERVICE_FORCE_INTEL to GNU
0: WARNING 24-11-16 15:43:39.011837 - 0:00:00 - WARNING: Setting OMP_NUM_THREADS to 1
0: WARNING 24-11-16 15:43:39.011932 - 0:00:00 - WARNING: Setting MKL_NUM_THREADS to 1
0: WARNING 24-11-16 15:43:39.011998 - 0:00:00 - WARNING: Setting ENABLE_INTRA_NODE_COMM to 1
0: WARNING 24-11-16 15:43:39.012051 - 0:00:00 - WARNING: Setting TORCH_NCCL_AVOID_RECORD_STREAMS to 1
0: WARNING 24-11-16 15:43:39.012103 - 0:00:00 - WARNING: Setting NCCL_IB_TIMEOUT to 22
0: WARNING 24-11-16 15:43:39.012151 - 0:00:00 - WARNING: Setting NCCL_DEBUG to INFO
0: WARNING 24-11-16 15:43:39.012202 - 0:00:00 - WARNING: Setting TRITON_CACHE_DIR to /scratch/ya255/tmp/tmpmd_mtsfe
0: INFO    24-11-16 15:43:43.642854 - 0:00:05 - Run launched with torchrun, local rank: 0
0: INFO    24-11-16 15:43:43.643157 - 0:00:05 - ENV: environ({'SHELL': '/bin/bash', 'SLURM_STEP_NUM_TASKS': '3', 'SLURM_JOB_USER': 'ya255', 'SLURM_TASKS_PER_NODE': '3', 'SLURM_JOB_UID': '1642556', 'SLURM_STEP_GPUS': '0', 'SLURM_CPU_BIND': 'quiet,mask_cpu:0x0000000000000001,0x0000000000000004,0x0000000000000008', 'SLURM_TASK_PID': '2950149', 'CONDA_EXE': '/share/apps/anaconda3/2021.05/bin/conda', '_CE_M': '', 'TMUX': '/tmp/tmux-1642556/default,2233183,4', 'SLURM_LOCALID': '0', 'SLURM_SUBMIT_DIR': '/home/ya255', 'SLURM_CPU_BIND_VERBOSE': 'quiet', 'SLURMD_NODENAME': 'abdelfattah-compute-03', 'SLURM_STEP_NODELIST': 'abdelfattah-compute-03', 'SLURM_CLUSTER_NAME': 'g2', 'SLURM_CPUS_ON_NODE': '3', 'SLURM_UMASK': '0002', 'SLURM_JOB_CPUS_PER_NODE': '3', 'ENV': '/usr/share/modules/init/profile.sh', 'SLURM_GPUS_ON_NODE': '1', 'KRB5CCNAME': 'FILE:/tmp/krb5cc_1642556_HhGMYr', 'PWD': '/scratch/ya255/lingua', 'SLURM_GTIDS': '0,1,2', 'LOGNAME': 'ya255', 'CONDA_PREFIX': '/home/ya255/.conda/envs/lingua_241023', 'SLURM_JOB_PARTITION': 'abdelfattah-interactive', 'MODULESHOME': '/usr/share/modules', 'MANPATH': ':', 'ROCR_VISIBLE_DEVICES': '0', 'SLURM_JOB_NUM_NODES': '1', 'SRUN_DEBUG': '3', 'SLURM_STEPID': '0', 'SLURM_CPU_BIND_LIST': '0x0000000000000001,0x0000000000000004,0x0000000000000008', 'SLURM_JOBID': '5887989', 'SLURM_PTY_PORT': '62270', 'SLURM_LAUNCH_NODE_IPADDR': '128.84.101.4', 'SLURM_JOB_QOS': 'normal', 'MOTD_SHOWN': 'pam', 'SLURM_PTY_WIN_ROW': '14', 'HOME': '/home/ya255', 'LANG': 'en_US.UTF-8', 'SLURM_CPU_BIND_TYPE': 'mask_cpu:', 'LS_COLORS': 'rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:', 'SLURM_PROCID': '0', 'CONDA_PROMPT_MODIFIER': '(lingua_241023) ', 'TMPDIR': '/scratch/ya255/tmp', 'SLURM_NTASKS': '3', 'SLURM_TOPOLOGY_ADDR': 'abdelfattah-compute-03', 'SSH_CONNECTION': '10.41.228.20 49376 128.84.101.4 22', 'SLURM_DISTRIBUTION': 'block,pack', 'ZE_AFFINITY_MASK': '0', 'SLURM_TOPOLOGY_ADDR_PATTERN': 'node', 'CUDA_VISIBLE_DEVICES': '0', 'SLURM_SRUN_COMM_HOST': '128.84.101.4', 'HF_HOME': '/scratch/ya255/huggingface', 'LESSCLOSE': '/usr/bin/lesspipe %s %s', 'MODULEPATH_modshare': '/etc/environment-modules/modules:1:/usr/share/modules/$MODULE_VERSION/modulefiles:1:/usr/share/modules/modulefiles:1:/usr/share/modules/versions:1', 'SLURM_WORKING_CLUSTER': 'g2:slurmctld:6817:9728:109', 'TERM': 'screen', '_CE_CONDA': '', 'SLURM_PTY_WIN_COL': '248', 'LESSOPEN': '| /usr/bin/lesspipe %s', 'USER': 'ya255', 'TMUX_PANE': '%25', 'SLURM_NODELIST': 'abdelfattah-compute-03', 'GPU_DEVICE_ORDINAL': '0', 'CONDA_SHLVL': '2', 'SLURM_SRUN_COMM_PORT': '62271', 'LOADEDMODULES': '', 'SLURM_STEP_ID': '0', 'SLURM_JOB_ACCOUNT': 'abdelfattah', 'SLURM_PRIO_PROCESS': '0', 'SLURM_NPROCS': '3', 'SHLVL': '3', 'SLURM_NNODES': '1', 'BASH_ENV': '/usr/share/modules/init/bash', 'SLURM_SUBMIT_HOST': 'g2-login-05.coecis.cornell.edu', 'CONDA_PYTHON_EXE': '/share/apps/anaconda3/2021.05/bin/python', 'LD_LIBRARY_PATH': '/home/ya255/cuda-11.8/lib64', 'SLURM_JOB_ID': '5887989', 'SLURM_NODEID': '0', 'SLURM_STEP_NUM_NODES': '1', 'SSH_CLIENT': '10.41.244.132 38532 22', 'CONDA_DEFAULT_ENV': 'lingua_241023', 'SLURM_STEP_TASKS_PER_NODE': '3', 'CUDA_HOME': '/home/ya255/cuda-11.8', 'SLURM_CONF': '/usr/local/slurm/slurm-22.05.8/etc/slurm.conf', 'PATH': '/home/ya255/cuda-11.8/bin:/home/ya255/cuda-12.1/bin:/home/ya255/.local/bin:/home/ya255/.conda/envs/lingua_241023/bin:/home/ya255/.local/bin:/home/ya255/cuda-11.8/bin:/home/ya255/cuda-12.1/bin:/home/ya255/.local/bin:/share/apps/anaconda3/2021.05/bin:/usr/local/slurm/current/bin:/usr/local/slurm/current/sbin:/usr/local/openmpi/current/bin:/usr/local/openmpi/current:/usr/local/slurm/current/bin:/usr/local/slurm/current/sbin:/usr/local/openmpi/current/bin:/usr/local/openmpi/current:/home/ya255/.local/bin:/home/ya255/cuda-11.8/bin:/home/ya255/cuda-12.1/bin:/home/ya255/.local/bin:/share/apps/anaconda3/2021.05/bin:/share/apps/anaconda3/2021.05/condabin:/share/apps/anaconda3/2021.05/bin:/usr/local/slurm/current/bin:/usr/local/slurm/current/sbin:/usr/local/openmpi/current/bin:/usr/local/openmpi/current:/usr/local/slurm/current/bin:/usr/local/slurm/current/sbin:/usr/local/openmpi/current/bin:/usr/local/openmpi/current:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin', 'SLURM_JOB_NAME': 'bash', 'MODULEPATH': '/etc/environment-modules/modules:/usr/share/modules/versions:/usr/share/modules/$MODULE_VERSION/modulefiles:/usr/share/modules/modulefiles', 'SSH_TTY': '/dev/pts/155', 'CONDA_PREFIX_1': '/share/apps/anaconda3/2021.05', 'SLURM_STEP_LAUNCHER_PORT': '62271', 'SLURM_JOB_GID': '1658701', 'SLURM_JOB_NODELIST': 'abdelfattah-compute-03', 'MODULES_CMD': '/usr/lib/x86_64-linux-gnu/modulecmd.tcl', 'BASH_FUNC_switchml%%': '() {  typeset swfound=1;\n if [ "${MODULES_USE_COMPAT_VERSION:-0}" = \'1\' ]; then\n typeset swname=\'main\';\n if [ -e /usr/lib/x86_64-linux-gnu/modulecmd.tcl ]; then\n typeset swfound=0;\n unset MODULES_USE_COMPAT_VERSION;\n fi;\n else\n typeset swname=\'compatibility\';\n if [ -e /usr/lib/x86_64-linux-gnu/modulecmd-compat ]; then\n typeset swfound=0;\n MODULES_USE_COMPAT_VERSION=1;\n export MODULES_USE_COMPAT_VERSION;\n fi;\n fi;\n if [ $swfound -eq 0 ]; then\n echo "Switching to Modules $swname version";\n source /usr/share/modules/init/bash;\n else\n echo "Cannot switch to Modules $swname version, command not found";\n return 1;\n fi\n}', 'BASH_FUNC_module%%': '() {  _module_raw "$@" 2>&1\n}', 'BASH_FUNC__module_raw%%': '() {  unset _mlshdbg;\n if [ "${MODULES_SILENT_SHELL_DEBUG:-0}" = \'1\' ]; then\n case "$-" in \n *v*x*)\n set +vx;\n _mlshdbg=\'vx\'\n ;;\n *v*)\n set +v;\n _mlshdbg=\'v\'\n ;;\n *x*)\n set +x;\n _mlshdbg=\'x\'\n ;;\n *)\n _mlshdbg=\'\'\n ;;\n esac;\n fi;\n unset _mlre _mlIFS;\n if [ -n "${IFS+x}" ]; then\n _mlIFS=$IFS;\n fi;\n IFS=\' \';\n for _mlv in ${MODULES_RUN_QUARANTINE:-};\n do\n if [ "${_mlv}" = "${_mlv##*[!A-Za-z0-9_]}" -a "${_mlv}" = "${_mlv#[0-9]}" ]; then\n if [ -n "`eval \'echo ${\'$_mlv\'+x}\'`" ]; then\n _mlre="${_mlre:-}${_mlv}_modquar=\'`eval \'echo ${\'$_mlv\'}\'`\' ";\n fi;\n _mlrv="MODULES_RUNENV_${_mlv}";\n _mlre="${_mlre:-}${_mlv}=\'`eval \'echo ${\'$_mlrv\':-}\'`\' ";\n fi;\n done;\n if [ -n "${_mlre:-}" ]; then\n eval `eval ${_mlre}/usr/bin/tclsh8.6 /usr/lib/x86_64-linux-gnu/modulecmd.tcl bash \'"$@"\'`;\n else\n eval `/usr/bin/tclsh8.6 /usr/lib/x86_64-linux-gnu/modulecmd.tcl bash "$@"`;\n fi;\n _mlstatus=$?;\n if [ -n "${_mlIFS+x}" ]; then\n IFS=$_mlIFS;\n else\n unset IFS;\n fi;\n unset _mlre _mlv _mlrv _mlIFS;\n if [ -n "${_mlshdbg:-}" ]; then\n set -$_mlshdbg;\n fi;\n unset _mlshdbg;\n return $_mlstatus\n}', 'OLDPWD': '/home/ya255', '_': '/home/ya255/.conda/envs/lingua_241023/bin/torchrun', 'LOCAL_RANK': '0', 'RANK': '0', 'GROUP_RANK': '0', 'ROLE_RANK': '0', 'ROLE_NAME': 'default', 'LOCAL_WORLD_SIZE': '1', 'WORLD_SIZE': '1', 'GROUP_WORLD_SIZE': '1', 'ROLE_WORLD_SIZE': '1', 'MASTER_ADDR': '127.0.0.1', 'MASTER_PORT': '29506', 'TORCHELASTIC_RESTART_COUNT': '0', 'TORCHELASTIC_MAX_RESTARTS': '0', 'TORCHELASTIC_RUN_ID': 'none', 'TORCHELASTIC_USE_AGENT_STORE': 'True', 'TORCH_NCCL_ASYNC_ERROR_HANDLING': '1', 'TORCHELASTIC_ERROR_FILE': '/scratch/ya255/tmp/torchelastic_jbvfnl6u/none_k9xa5je2/attempt_0/0/error.json', 'CUDA_MODULE_LOADING': 'LAZY', 'MKL_SERVICE_FORCE_INTEL': 'GNU', 'OMP_NUM_THREADS': '1', 'MKL_NUM_THREADS': '1', 'ENABLE_INTRA_NODE_COMM': '1', 'TORCH_NCCL_AVOID_RECORD_STREAMS': '1', 'NCCL_IB_TIMEOUT': '22', 'NCCL_DEBUG': 'INFO', 'TRITON_CACHE_DIR': '/scratch/ya255/tmp/tmpmd_mtsfe'})
0: INFO    24-11-16 15:43:43.672016 - 0:00:05 - Starting job: xmer_60k_dclm_65M
0: INFO    24-11-16 15:43:43.672266 - 0:00:05 - Running on dp rank : 0
0: INFO    24-11-16 15:43:43.672353 - 0:00:05 - Running on dp size : 1
0: INFO    24-11-16 15:43:43.674645 - 0:00:05 - Building model
0: INFO    24-11-16 15:43:43.952978 - 0:00:05 - Model is built !
0: INFO    24-11-16 15:43:45.916187 - 0:00:07 - Model size: 30,876,416 total parameters
0: INFO    24-11-16 15:43:45.916896 - 0:00:07 - GPU capacity: NVIDIA RTX A6000 (0) with 47.54GiB memory
0: INFO    24-11-16 15:43:45.918363 - 0:00:07 - GPU memory usage: NVIDIA RTX A6000 (0): 47.535888671875 GiB capacity, 0.169921875 GiB peak, 0.35746018376329564% peak
0: INFO    24-11-16 15:43:45.918446 - 0:00:07 - Starting build of optimizer...
0: INFO    24-11-16 15:43:45.919222 - 0:00:07 - Done with build of optimizer.
0: INFO    24-11-16 15:43:45.921822 - 0:00:07 - Async dataloader started
0: INFO    24-11-16 15:43:45.922914 - 0:00:07 - Profiling active.  Traces will be saved at /scratch/ya255/lingua/reported_runs/xmer_60k_dclm_65M/profiling
0: INFO    24-11-16 15:43:45.923171 - 0:00:07 - Starting MemSnapshotsProfilerWandb profiler...
0: INFO    24-11-16 15:43:49.759637 - 0:00:11 - Async data process 3002257 exited with code 1
0: INFO    24-11-16 15:43:49.759782 - 0:00:11 - Async dataloader cleaned up
